(this["webpackJsonpstrava-react-client"]=this["webpackJsonpstrava-react-client"]||[]).push([[0],{129:function(e,t,a){e.exports=a(324)},324:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(89),s=a.n(r),c=a(4),l=a(5),o=a(7),m=a(6),d=a(8),u=(a(93),a(330)),p=a(128),h=a(328),v=a(62),g=v.initializeApp({apiKey:"AIzaSyAT-v8o3B_cYtmaQOcOAaZypeXQC4W1lH8",authDomain:"banana-dd8f3.firebaseapp.com",databaseURL:"https://banana-dd8f3.firebaseio.com",projectId:"banana-dd8f3",storageBucket:"banana-dd8f3.appspot.com",messagingSenderId:"33006064885"}),f=function(e,t,a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var i="expires="+n.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"},y=function(e){for(var t=e+"=",a=decodeURIComponent(document.cookie).split(";"),n=0;n<a.length;n++){for(var i=a[n];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""},b=a(24),E=a.n(b),S=a(90),_=a(19),N=a.n(_),x=a(3),k=a.n(x);function w(e){var t=e.mapDimension||"400x400",a="https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyAsyxYCjxLqi49yGUuqUJRa4cYN8V4VyLE&path=weight:4%7Ccolor:0x3B8BFFff%7Cenc:"+e.mapPolyline+"&format=png&maptype=roadmap&style=feature:water%7Celement:geometry.fill%7Ccolor:0x75cff0&size="+t;return e.mapPolyline?i.a.createElement("div",{className:"c-activity-map"},i.a.createElement("img",{className:"c-activity-map__image",src:a,alt:""})):i.a.createElement("div",{className:"c-activity-map"},i.a.createElement("span",{className:"c-activity-map__message"},"No Location Information"))}function j(e){return e.commute?i.a.createElement("span",{className:"c-label c-label--sm"},"commute"):null}function C(e){return i.a.createElement("div",{className:"c-activity__stat"},i.a.createElement("label",{className:"c-activity__stat-label"},e.label),i.a.createElement("span",{className:"\n        c-activity__stat-value\n        ".concat(e.type?"c-activity__stat-value--"+e.type:"","\n        ")},e.value,i.a.createElement("span",{className:"c-activity__stat-unit"},e.unit)))}function O(e){return i.a.createElement("div",null,i.a.createElement("div",{className:"c-activity__header"},i.a.createElement("div",null,i.a.createElement("h3",{className:"c-activity__title"},i.a.createElement(S.a,{to:"/activities/"+e.data.id},e.data.name)),i.a.createElement("span",{className:"c-activity__time"},i.a.createElement(E.a,{format:"MMM DD, YYYY"},e.data.start_date)," at ",i.a.createElement(E.a,{format:"hh:mm a"},e.data.start_date))),i.a.createElement(j,{commute:e.data.commute})))}var P=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=Math.floor(this.props.data.distance/1e3),t=k.a.round(60*this.props.data.average_speed*60/1e3,1),a=Math.floor(this.props.data.total_elevation_gain),n=N.a.duration(this.props.data.moving_time,"seconds"),r=n._data.hours+":"+n._data.minutes+":"+n._data.seconds;return i.a.createElement(S.a,{to:"/activities/"+this.props.data.id},i.a.createElement("div",{className:"c-activity"},i.a.createElement(w,{className:"c-activity__map",mapPolyline:this.props.data.map.summary_polyline}),i.a.createElement("div",{className:"c-activity__meta"},i.a.createElement(O,{favourite:this.props.favourite,data:this.props.data}),i.a.createElement("div",{className:"c-activity__stats"},i.a.createElement(C,{label:"distance",value:e,unit:"km"}),i.a.createElement(C,{label:"climb",value:a,unit:"m"}),i.a.createElement(C,{label:"duration",value:r}),i.a.createElement(C,{label:"average speed",value:t,unit:"km/h"})),i.a.createElement("div",{className:"o-flex o-flex-justify--end"},this.props.data.has_heartrate&&i.a.createElement("div",{className:"c-activity__has-chart-icon c-activity__has-chart-icon--heartrate"}," ",i.a.createElement("div",{className:"c-tooltip"},"Heartrate")),this.props.data.average_cadence&&i.a.createElement("div",{className:"c-activity__has-chart-icon c-activity__has-chart-icon--cadence"}," ",i.a.createElement("div",{className:"c-tooltip"},"Cadence")),this.props.data.device_watts&&i.a.createElement("div",{className:"c-activity__has-chart-icon c-activity__has-chart-icon--power"}," ",i.a.createElement("div",{className:"c-tooltip"},"Power"))))))}}]),t}(n.Component),L=a(63),T=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelector(".c-loader__svg-stroke"),t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=2*t}},{key:"render",value:function(){return i.a.createElement("div",{className:"c-loading_spinner-wrap"},i.a.createElement("svg",{width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{className:"c-loader__svg-stroke",d:"M14 2C7.37258 2 2 7.37258 2 14C2 20.6274 7.37258 26 14 26C20.6274 26 26 20.6274 26 14C26 10.6249 24.6066 7.57515 22.3636 5.39478",stroke:"#FFC236",strokeWidth:"3",fill:"none",strokeLinecap:"round"})))}}]),t}(n.Component),D=function(e){return i.a.createElement("div",{className:e.className},i.a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("title",null,"arrow--right"),i.a.createElement("path",{d:"M9.586 9H4c-.552 0-1-.448-1-1s.448-1 1-1h5.586L7.293 4.707c-.39-.39-.39-1.024 0-1.414.39-.39 1.024-.39 1.414 0l4 4c.39.39.39 1.024 0 1.414l-4 4c-.39.39-1.024.39-1.414 0-.39-.39-.39-1.024 0-1.414L9.586 9z","fill-rule":"nonzero"})))},I=function(e){return i.a.createElement("div",{className:e.className},i.a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("title",null,"arrow--left"),i.a.createElement("path",{d:"M6.414 9H12c.552 0 1-.448 1-1s-.448-1-1-1H6.414l2.293-2.293c.39-.39.39-1.024 0-1.414-.39-.39-1.024-.39-1.414 0l-4 4c-.39.39-.39 1.024 0 1.414l4 4c.39.39 1.024.39 1.414 0 .39-.39.39-1.024 0-1.414L6.414 9z","fill-rule":"nonzero"})))},z=function(e){return i.a.createElement("div",{className:e.className},i.a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("title",null,"bookmark--solid"),i.a.createElement("path",{d:"M8 10.25L5.6 12.8c-.66.494-1.6.024-1.6-.8V5c0-1.17.82-2 2-2h4c1.18 0 2 .83 2 2v7c0 .824-.94 1.294-1.6.8L8 10.25z","fill-rule":"nonzero"})))},U=function(e){return i.a.createElement("div",{className:e.className},i.a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("title",null,"publish"),i.a.createElement("path",{d:"M14 8.578c0-1.423-1.205-2.593-2.703-2.54C10.712 4.836 9.457 4 8 4 6.056 4 4.472 5.48 4.36 7.347 3.14 7.1 2 8.003 2 9.214c0 1.938 2.087 1.908 2.087 1.908h7.565S14 10.824 14 8.578z","fill-rule":"evenodd","stroke-linejoin":"round"})))};function A(e){return i.a.createElement("ul",{className:"c-paginator"},i.a.createElement("li",{className:"c-paginator__link t-right-spacing--xs"},i.a.createElement("a",{className:1===e.pager.currentPage?"disabled c-btn":"c-btn",href:"/activities/page/"+e.pager.previousPage},i.a.createElement(I,null))),i.a.createElement("li",{className:"c-paginator__link t-left-spacing--xs"},i.a.createElement("a",{className:e.pager.isLastPage?"disabled c-btn":"c-btn",href:"/activities/page/"+e.pager.nextPage},i.a.createElement(D,null))))}var M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).checkFavouriteStatus=function(){},a.fetchData=function(){var e=y("access_token"),t=a.props.match.params.page||1;fetch("https://www.strava.com/api/v3/athlete/activities?page="+t,{method:"get",headers:{"content-type":"application/json",authorization:"Bearer "+e}}).then((function(e){return e.json()})).then((function(e){e.length<30?a.setState({data:e,loading:!1,pager:{isLastPage:!0,isFirstPage:!1,nextPage:null,currentPage:Number(a.props.match.params.page),previousPage:Number(a.props.match.params.page)-1}}):30===e.length&&a.props.match.params.page?a.setState({data:e,loading:!1,pager:{isLastPage:!1,isFirstPage:!1,nextPage:Number(a.props.match.params.page)+1,currentPage:Number(a.props.match.params.page),previousPage:Number(a.props.match.params.page)-1}}):a.setState({data:e,loading:!1,pager:{isLastPage:!1,isFirstPage:!0,nextPage:2,currentPage:1,previousPage:null}})}))},a.state={data:[],pager:{},loading:!0,userUid:e.userUid},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.setState({loading:!0})}},{key:"componentWillReceiveProps",value:function(){var e=this,t=[];g.database().ref("users/"+this.state.userUid+"/favourites").once("value",(function(a){a.forEach((function(e){var a=e.child("activityId").val();t.push(a)})),e.setState({loading:!1,favouritesList:t})}))}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this,t=this.state.data.map((function(t,a){var n;return e.state.favouritesList&&(n=k.a.includes(e.state.favouritesList,String(t.id))),i.a.createElement(P,{favourite:n,key:a,data:t,mapDimension:"400x400"})}));return this.state.loading?i.a.createElement("div",{className:"o-flex o-flex-align--center o-flex-justify--center t-full-height"},i.a.createElement(T,null)):i.a.createElement("div",{className:"o-wrapper"},i.a.createElement("div",null,i.a.createElement(S.a,{to:"/year-review"},i.a.createElement("div",{className:"c-yrt-card t-top-spacing--xl"},i.a.createElement(D,{className:"c-yrt-card__right-arrow"}),i.a.createElement("h2",{className:"c-yrt-card__header"},"Your Year in Review"),i.a.createElement("p",{className:"c-yrt-card__description"},"Check your progress for 2020."))),i.a.createElement("div",{className:"c-page-header"},i.a.createElement("h1",null,"All Activities")),i.a.createElement(L.CSSTransitionGroup,{transitionName:"o-transition",transitionAppear:!0,transitionAppearTimeout:500,transitionEnterTimeout:500,transitionLeaveTimeout:300},t),i.a.createElement(A,{pager:this.state.pager})))}}]),t}(n.Component),B=a(327),F="https://strava-auth.herokuapp.com",R="";F="https://strava-auth.herokuapp.com",R="";var W,Y,H,J,G=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("a",{href:F},i.a.createElement("img",{alt:"",src:R+"/img/btn_strava_connectwith_orange.svg"}))}}]),t}(n.Component),q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).state={data:{}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.authState){var t=y("access_token");fetch("https://www.strava.com/api/v3/athlete",{method:"get",headers:{"content-type":"application/json",authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(t){e.setState({data:t})}))}}},{key:"render",value:function(){return"private"===this.props.type?i.a.createElement("div",{className:"c-navigation"},i.a.createElement("ul",{className:"c-navigation__nav o-flex o-flex-justify--space-between"},i.a.createElement(S.a,{activeClassName:"test",to:"/"},i.a.createElement("h4",{className:"c-navigation__logo"},i.a.createElement("span",{"aria-label":"banana",role:"img"},"\ud83c\udf4c")," ","banana")),i.a.createElement("div",{className:"o-flex"},i.a.createElement(B.a,{className:"c-navigation__nav-item",activeClassName:"active",exact:!0,to:"/favourites"},i.a.createElement(z,null),i.a.createElement("div",{className:"c-tooltip"},"Favourites")))),i.a.createElement(V,{data:this.state.data})):i.a.createElement("div",{className:"c-navigation"},i.a.createElement(B.a,{activeClassName:"active",exact:!0,to:"/"},i.a.createElement("h4",{className:"c-navigation__logo"},i.a.createElement("span",{"aria-label":"banana",role:"img"},"\ud83c\udf4c")," ","banana")),i.a.createElement(G,null))}}]),t}(n.Component),V=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(o.a)(this,Object(m.a)(t).call(this))).logout=function(){!function(e){var t=new Date;t.setTime(t.getTime()-864e6);var a="expires="+t.toUTCString();document.cookie="access_token=;path=/;"+a}(),g.auth().signOut().then((function(){window.location.assign("/")})).catch((function(e){}))},e.showDropdown=function(){e.setState({showDropdown:!e.state.showDropdown})},e.state={showDropdown:!1},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"c-navigation__profile"},i.a.createElement("a",{onClick:this.showDropdown,href:"#"},i.a.createElement("img",{className:"c-navigation__profile-image",src:this.props.data.profile,alt:""})),i.a.createElement("ul",{className:this.state.showDropdown?"show c-navigation__dropdown":"c-navigation__dropdown"},i.a.createElement("li",{className:"c-navigation__dropdown-info"},i.a.createElement("h3",{className:"c-navigation__dropdown-name"},this.props.data.firstname," ",this.props.data.lastname),i.a.createElement("h3",{className:"c-navigation__dropdown-location"},this.props.data.country,", ",this.props.data.city)),i.a.createElement("a",{onClick:this.logout},i.a.createElement("li",{className:"c-navigation__dropdown-link"},"Log Out"))))}}]),t}(n.Component),Z=q,K=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e;!function(){var e=window.location.search.substring(1),t=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');console.log(t),W=t.access_token,Y=t.firebase_token,H=t.refresh_token,J=t.expires_at}(),f("access_token",W,7),f("token_expires_at",J,7),f("refresh_token",H,7),e=Y,g.auth().signInWithCustomToken(e).catch((function(e){console.log(e.code),console.log(e.message)})),v.auth().onAuthStateChanged((function(e){e&&console.log("logged in with firebase",e.uid)}))}},{key:"render",value:function(){return i.a.createElement(h.a,{to:"/"})}}]),t}(n.Component),X=a(27);X.b.global.elements.point.borderWidth=0,X.b.global.elements.point.radius=0,X.b.global.elements.point.backgroundColor="rgba(0,0,0,0)",X.b.global.elements.line.tension=.25,X.b.global.elements.line.borderWidth=0,X.b.global.defaultFontFamily="'-apple-system','Helvetica Neue', 'Helvetica', 'Arial', sans-serif";var Q=function(e){var t,a,n=k.a.map(e.distanceStream,(function(e){return k.a.round(e/1e3,2)}));return"heartrate"===e.dataType?(a={labels:n,datasets:[{label:e.dataTypeLegendLabel,borderColor:"rgba(255, 255, 255, 1)",borderWidth:1,yAxisID:"main-data-y-axis",fill:!1,data:e.mainDataStream},{label:"Elevation",fill:!0,backgroundColor:"rgba(0,0,0,0.5)",borderColor:"rgba(0,0,0,0)",borderWidth:0,data:e.altitudeStream}]},t={layout:{padding:0},responsive:!0,maintainAspectRatio:!0,legend:{display:!1,usePointStyle:!0,position:"bottom",labels:{boxWidth:10,padding:20}},tooltips:{mode:"index",intersect:!1,displayColors:!1,xPadding:10,yPadding:10},hover:{mode:"nearest",intersect:!0,animationDuration:1e3},scales:{xAxes:[{type:"category",display:!1,ticks:{fontSize:9,autoSkipPadding:400,maxRotation:0,callback:function(e){return k.a.round(e,1)+" km"}},stepSize:10}],yAxes:[{display:!1,id:"altitude-y-axis",position:"left",borderColor:"rgba(0, 140, 255, 0.9)",ticks:{fontSize:9,stepSize:50,autoSkip:!0,autoSkipPadding:400,callback:function(e){return k.a.round(e,0)+" m"}}},{display:!0,id:"main-data-y-axis",position:"right",ticks:{fontSize:9,fontColor:"rgba(255,255,255,0.5)",autoSkip:!0,autoSkipPadding:400,callback:function(t){return k.a.round(t,0)+" "+e.dataTypeUnit}}}]}}):"velocity"===e.dataType?(a={labels:n,datasets:[{label:e.dataTypeLegendLabel,borderColor:"rgba(255, 255, 255, 1)",borderWidth:1,yAxisID:"main-data-y-axis",fill:!1,data:e.mainDataStream},{label:"Elevation",fill:!0,backgroundColor:"rgba(0,0,0,0.5)",borderColor:"rgba(0,0,0,0)",borderWidth:0,data:e.altitudeStream}]},t={layout:{padding:0},responsive:!0,maintainAspectRatio:!0,legend:{display:!1,usePointStyle:!0,position:"bottom",labels:{boxWidth:10,padding:20}},tooltips:{mode:"index",intersect:!1,displayColors:!1,xPadding:10,yPadding:10},hover:{mode:"nearest",intersect:!0,animationDuration:1e3},scales:{xAxes:[{type:"category",display:!1,ticks:{fontSize:9,autoSkipPadding:400,maxRotation:0,callback:function(e){return k.a.round(e,1)+" km"}},stepSize:10}],yAxes:[{display:!1,id:"altitude-y-axis",position:"left",borderColor:"rgba(0, 140, 255, 0.9)",ticks:{fontSize:9,stepSize:50,autoSkip:!0,autoSkipPadding:400,callback:function(e){return k.a.round(e,0)+" m"}}},{display:!0,id:"main-data-y-axis",position:"right",ticks:{fontSize:9,fontColor:"rgba(255,255,255,0.5)",autoSkip:!0,autoSkipPadding:400,callback:function(t){return k.a.round(t,0)+" "+e.dataTypeUnit}}}]}}):"cadence"===e.dataType?(a={labels:n,datasets:[{label:e.dataTypeLegendLabel,borderColor:"rgba(255, 255, 255, 1)",borderWidth:0,pointRadius:.5,pointBorderWidth:1,showLine:!1,pointBackgroundColor:"rgba(255, 255, 255, 1)",yAxisID:"main-data-y-axis",fill:!1,data:e.mainDataStream},{label:"Elevation",fill:!0,backgroundColor:"rgba(0,0,0,0.5)",borderColor:"rgba(0,0,0,0)",borderWidth:0,data:e.altitudeStream}]},t={layout:{padding:0},responsive:!0,maintainAspectRatio:!0,legend:{display:!1,usePointStyle:!0,position:"bottom",labels:{boxWidth:10,padding:20}},tooltips:{mode:"index",intersect:!1,displayColors:!1,xPadding:10,yPadding:10},hover:{mode:"nearest",intersect:!0,animationDuration:1e3},scales:{xAxes:[{type:"category",display:!1,ticks:{fontSize:9,autoSkipPadding:400,maxRotation:0,callback:function(e){return k.a.round(e,1)+" km"}},stepSize:10}],yAxes:[{display:!1,id:"altitude-y-axis",position:"left",borderColor:"rgba(0, 140, 255, 0.9)",ticks:{fontSize:9,stepSize:50,autoSkip:!0,autoSkipPadding:400,callback:function(e){return k.a.round(e,0)+" m"}}},{display:!0,id:"main-data-y-axis",position:"right",ticks:{fontSize:9,fontColor:"rgba(255,255,255,0.5)",autoSkip:!0,autoSkipPadding:400,callback:function(t){return k.a.round(t,0)+" "+e.dataTypeUnit}}}]}}):(a={labels:n,datasets:[{label:e.dataTypeLegendLabel,borderColor:"rgba(255, 255, 255, 1)",borderWidth:1,yAxisID:"main-data-y-axis",fill:!1,data:e.mainDataStream,cubicInterpolationMode:"monotone"},{label:"Elevation",fill:!0,backgroundColor:"rgba(0,0,0,0.5)",borderColor:"rgba(0,0,0,0)",borderWidth:0,data:e.altitudeStream}]},t={layout:{padding:0},responsive:!0,maintainAspectRatio:!0,legend:{display:!1,usePointStyle:!0,position:"bottom",labels:{boxWidth:10,padding:20}},tooltips:{mode:"index",intersect:!1,displayColors:!1,xPadding:10,yPadding:10},hover:{mode:"nearest",intersect:!0,animationDuration:1e3},scales:{xAxes:[{type:"category",display:!1,ticks:{fontSize:9,autoSkipPadding:400,maxRotation:0,callback:function(e){return k.a.round(e,1)+" km"}},stepSize:10}],yAxes:[{display:!1,id:"altitude-y-axis",position:"left",borderColor:"rgba(0, 140, 255, 0.9)",ticks:{fontSize:9,stepSize:50,autoSkip:!0,autoSkipPadding:400,callback:function(e){return k.a.round(e,0)+" m"}}},{display:!0,id:"main-data-y-axis",position:"right",ticks:{fontSize:9,fontColor:"rgba(255,255,255,0.5)",autoSkip:!0,autoSkipPadding:400,callback:function(t){return k.a.round(t,0)+" "+e.dataTypeUnit}}}]}}),i.a.createElement(X.a,{data:a,options:t,width:40,height:10})},$=a(34),ee=a.n($),te=a(126),ae=a.n(te),ne=y("access_token"),ie=20,re=.5;ne?(ie=4,re=1):(ie=50,re=0);var se=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=ae.a.toGeoJSON(this.props.mapPolyline).coordinates,t=this.props.startLatlng,a=this.props.endLatlng;ee.a.accessToken="pk.eyJ1IjoicDBwbWFrZXIiLCJhIjoiY2lzOXliOGlrMDA2ODJ5bzJ4YjNnb29qdSJ9.hf19Sca7oYCcR8kRlx07Rw";var n=new ee.a.Map({container:this.container,style:"mapbox://styles/mapbox/streets-v9",center:[t[1],t[0]],zoom:10});n.on("load",(function(){n.addLayer({id:"route",type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}}},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#0a67f2","line-width":2}}),n.addLayer({id:"start",type:"circle",source:{type:"geojson",data:{type:"Feature",properties:{description:"Activity Start"},geometry:{type:"Point",coordinates:[t[1],t[0]]}}},paint:{"circle-color":"#41c15a","circle-radius":ie,"circle-opacity":re}}),n.addLayer({id:"end",type:"circle",source:{type:"geojson",data:{type:"Feature",properties:{description:"Activitiy End"},geometry:{type:"Point",coordinates:[a[1],a[0]]}}},paint:{"circle-color":"#f03434","circle-radius":ie,"circle-opacity":re}});var i=e,r=i.reduce((function(e,t){return e.extend(t)}),new ee.a.LngLatBounds(i[0],i[0]));n.fitBounds(r,{padding:80}),n.addControl(new ee.a.NavigationControl),n.scrollZoom.disable();var s=new ee.a.Popup({closeButton:!1,closeOnClick:!1});n.on("mouseenter","start",(function(e){n.getCanvas().style.cursor="pointer",s.setLngLat(e.features[0].geometry.coordinates).setHTML(e.features[0].properties.description).addTo(n)})),n.on("mouseleave","start",(function(){n.getCanvas().style.cursor="",s.remove()})),n.on("mouseenter","end",(function(e){n.getCanvas().style.cursor="pointer",s.setLngLat(e.features[0].geometry.coordinates).setHTML(e.features[0].properties.description).addTo(n)})),n.on("mouseleave","end",(function(){n.getCanvas().style.cursor="",s.remove()}))}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"c-activity-interactive-map-container"},i.a.createElement("div",{className:"c-activity-interactive-map",ref:function(t){e.container=t}}))}}]),t}(n.Component),ce=a(66),le=a.n(ce),oe=a(67),me=a.n(oe);var de,ue,pe,he,ve,ge,fe,ye,be,Ee,Se,_e,Ne,xe,ke,we,je,Ce,Oe,Pe,Le,Te,De=function(e){return i.a.createElement("div",{className:"c-box c-activity-food-card"},i.a.createElement("h4",{className:"c-activity-food-card__header"},e.name),i.a.createElement("h1",{className:"c-activity-food-card__number"},e.value),i.a.createElement("img",{className:"c-activity-food-card__image c-activity-food-card__image--filter",src:e.imageSrc,alt:""}),i.a.createElement("img",{className:"c-activity-food-card__image",src:e.imageSrc,alt:""}))},Ie=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).checkStatus=function(){var e=g.database().ref("users/"+a.props.userUid+"/favourites"),t=a.props.activityId;e.once("value",(function(e){e.forEach((function(e){e.child("activityId").val()===t&&(console.log("activity is favourited"),a.setState({isFavourite:!0}))})),a.setState({loading:!1})}))},a.unfavouriteThis=function(){var e=g.database().ref("users/"+a.props.userUid+"/favourites"),t=a.props.activityId;a.state.isFavourite&&(e.once("value",(function(e){e.forEach((function(e){e.child("activityId").val()===t&&(console.log("remove from firebase"),e.ref.remove())}))})),a.setState({isFavourite:!1}))},a.favouriteThis=function(){var e=g.database().ref("users/"+a.props.userUid+"/favourites"),t=a.props.activityId,n=e.push();a.state.isFavourite||(console.log("add to favourites"),n.set({activityId:t,activityData:a.props.data}),a.setState({isFavourite:!0}))},a.state={isFavourite:!1,loading:!0},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.checkStatus()}},{key:"render",value:function(){return this.state.loading?i.a.createElement("button",{disabled:!0,className:"c-btn c-btn--favourite",onClick:this.favouriteThis},i.a.createElement(z,{className:"c-icon"})," ",i.a.createElement("span",null,"Favourite")):i.a.createElement("div",null,this.state.isFavourite?i.a.createElement("button",{className:"c-btn c-btn--favourite is-favourite",onClick:this.unfavouriteThis},i.a.createElement(z,{className:"c-icon"})," ",i.a.createElement("span",null,"Favourited")):i.a.createElement("button",{className:"c-btn c-btn--favourite",onClick:this.favouriteThis},i.a.createElement(z,{className:"c-icon"})," ",i.a.createElement("span",null,"Favourite")))}}]),t}(n.Component),ze=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).checkStatus=function(){var e=g.database().ref("users/"+a.props.userUid+"/publicActivities"),t=a.props.activityId;e.once("value",(function(e){e.forEach((function(e){e.child("activityId").val()===t&&(console.log("activity is in public stream"),a.setState({isPublic:!0}))})),a.setState({loading:!1})}))},a.removeFromPublicStream=function(){var e=g.database().ref("users/"+a.props.userUid+"/publicActivities"),t=a.props.activityId;a.state.isPublic&&(e.once("value",(function(e){e.forEach((function(e){e.child("activityId").val()===t&&(console.log("remove from public stream"),e.ref.remove())}))})),a.setState({isPublic:!1}))},a.addToPublicStream=function(){var e=g.database().ref("users/"+a.props.userUid+"/publicActivities"),t=a.props.activityId,n=e.push();a.state.isPublic||(console.log("add to public stream"),n.set({activityId:t,activityData:a.props.data,altitudeStream:a.props.altitudeStream||null,distanceStream:a.props.distanceStream||null,latLngStream:a.props.latLngStream||null,velocityStream:a.props.velocityStream||null,cadenceStream:a.props.cadenceStream||null,heartrateStream:a.props.heartrateStream||null,wattsStream:a.props.wattsStream||null}),a.setState({isPublic:!0}))},a.state={isPublic:!1,loading:!0},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.checkStatus()}},{key:"render",value:function(){return this.state.loading?i.a.createElement("button",{disabled:!0,className:"c-btn c-btn--publish",onClick:this.addToPublicStream},i.a.createElement(U,{className:"c-icon"})," ",i.a.createElement("span",null,"Publish")):i.a.createElement("div",null,this.state.isPublic?i.a.createElement("div",{className:"o-flex o-flex-align--center"},i.a.createElement("button",{className:"c-btn c-btn--publish is-public",onClick:this.removeFromPublicStream},i.a.createElement(U,{className:"c-icon"})," ",i.a.createElement("span",null,"Published")),i.a.createElement("a",{className:"c-link t-left-spacing",target:"_blank",rel:"noopener noreferrer",href:"/public/"+this.props.userUid+"/"+this.props.activityId}," ","Open Public Link")):i.a.createElement("button",{className:"c-btn c-btn--publish",onClick:this.addToPublicStream},i.a.createElement(U,{className:"c-icon"})," ",i.a.createElement("span",null,"Publish")))}}]),t}(n.Component),Ue=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"c-page-header"},i.a.createElement("h3",{className:"o-activity-detail-name"},this.props.data.name),i.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",className:"o-activity-detail-time",href:"https://strava.com/activities/"+this.props.data.id},i.a.createElement("span",null,i.a.createElement(E.a,{format:"MMM DD, YYYY"},this.props.data.start_date),i.a.createElement("span",null," at "),i.a.createElement(E.a,{format:"hh:mm a"},this.props.data.start_date))),i.a.createElement("div",{className:"t-top-spacing--l o-flex"},i.a.createElement("div",{className:"t-right-spacing"},i.a.createElement(Ie,{userUid:this.props.userUid,activityId:this.props.activityId,data:this.props.data})),i.a.createElement("div",null,i.a.createElement(ze,{userUid:this.props.userUid,activityId:this.props.activityId,data:this.props.data,altitudeStream:this.props.altitudeStream,cadenceStream:this.props.cadenceStream,distanceStream:this.props.distanceStream,heartrateStream:this.props.heartrateStream,wattsStream:this.props.wattsStream,latLngStream:this.props.latLngStream,velocityStream:this.props.velocityStream})))))}}]),t}(n.Component),Ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).downloadSpeedChart=function(){var e=document.getElementById("activityCard--speed");le.a.toBlob(e).then((function(e){me.a.saveAs(e,"speed_chart.png")})).catch((function(e){console.error("oops, something went wrong!",e)}))},a.downloadHeartrateChart=function(){var e=document.getElementById("activityCard--heartrate");le.a.toBlob(e).then((function(e){me.a.saveAs(e,"heartrate_chart.png")})).catch((function(e){console.error("oops, something went wrong!",e)}))},a.downloadCadenceChart=function(){var e=document.getElementById("activityCard--cadence");le.a.toBlob(e).then((function(e){me.a.saveAs(e,"cadence_chart.png")})).catch((function(e){console.error("oops, something went wrong!",e)}))},new Promise((function(e,t){g.auth().onAuthStateChanged((function(a){a?e(a.uid):t(Error("It broke"))}))})).then((function(e){a.setState({userUid:e})})),a.state={data:[],gear:[],athlete:{},map:{},chartData:{},loading:!0,isFavourite:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("didmount");var t=y("access_token")||"011c89ee01402ab591de0240d59ee84455fd4d42",a="https://www.strava.com/api/v3/activities/"+this.props.match.params.id,n=a+"/streams/watts,altitude,heartrate,latlng,cadence,velocity_smooth?resolution=medium";this.setState({loading:!0}),fetch(a,{method:"get",headers:{"content-type":"application/json",authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({data:t,gear:t.gear,athlete:t.athlete,map:t.map})})).catch((function(e){console.log(e)})),t&&fetch(n,{method:"get",headers:{"content-type":"application/json",authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(t){function a(e){return"distance"===e.type}function n(e){return"heartrate"===e.type}function i(e){return"altitude"===e.type}function r(e){return"latlng"===e.type}function s(e){return"cadence"===e.type}function c(e){return"velocity_smooth"===e.type}function l(e){return"watts"===e.type}if(t.find(a)&&e.setState({distanceStream:t.find(a).data}),t.find(i)&&e.setState({altitudeStream:t.find(i).data}),t.find(n)&&e.setState({heartrateStream:t.find(n).data}),t.find(r)&&e.setState({latLngStream:t.find(r).data}),t.find(s)&&e.setState({cadenceStream:t.find(s).data}),t.find(l)&&e.setState({wattsStream:t.find(l).data}),t.find(c)){var o=t.find(c).data,m=k.a.map(o,(function(e){var t=60*(e/1e3)*60;return k.a.round(t,2)}));e.setState({velocityStream:m})}e.setState({loading:!1})})).catch((function(e){console.log("error fetching stream")}))}},{key:"render",value:function(){return de=k.a.round(this.state.data.distance/1e3,1),ue=k.a.round(this.state.data.total_elevation_gain,0),pe=this.state.data.calories,he=N.a.duration(this.state.data.moving_time,"seconds"),ve=he._data.hours,ge=he._data.minutes,fe=he._data.seconds,ye=ve+":"+ge+":"+fe,be=k.a.round(60*this.state.data.average_speed*60/1e3,1),Ee=k.a.round(60*this.state.data.max_speed*60/1e3,1),Se=k.a.round(this.state.data.average_cadence,1),Ne=k.a.round(this.state.data.average_watts,1),xe=this.state.data.max_watts,we=this.state.data.device_watts,_e=this.state.data.average_heartrate,ke=this.state.data.max_heartrate,je=k.a.round(pe/90,1),Ce=k.a.round(pe/208,1),Oe=k.a.round(pe/50,1),k.a.round(pe/303,1),Pe=k.a.round(pe/180,1),Le=k.a.round(pe/240,1),Te=k.a.round(pe/272,1),this.state.loading?i.a.createElement("div",{className:"o-flex o-flex-align--center o-flex-justify--center t-full-height"},i.a.createElement(T,null)):i.a.createElement("div",{className:"o-wrapper o-activity-detail"},i.a.createElement(Ue,{data:this.state.data,userUid:this.state.userUid,activityId:this.props.match.params.id,altitudeStream:this.state.altitudeStream,cadenceStream:this.state.cadenceStream,distanceStream:this.state.distanceStream,heartrateStream:this.state.heartrateStream,wattsStream:this.state.wattsStream,latLngStream:this.state.latLngStream,velocityStream:this.state.velocityStream}),i.a.createElement("div",{className:"o-activity-detail__summary"},i.a.createElement("div",{className:"c-activity-summary o-flex o-flex-justify--start"},de?i.a.createElement(C,{type:"large",label:"distance",value:de,unit:"km"}):null,ue?i.a.createElement(C,{type:"large",label:"climb",value:ue,unit:"m"}):null,ye?i.a.createElement(C,{type:"large",label:"duration",value:ye}):null,pe?i.a.createElement(C,{type:"large",label:"calories",value:pe}):null),this.state.map.summary_polyline&&i.a.createElement(se,{mapPolyline:this.state.map.polyline||this.state.map.summary_polyline,startLatlng:this.state.data.start_latlng,endLatlng:this.state.data.end_latlng})),i.a.createElement("div",null,be?i.a.createElement("div",{id:"activityCard--speed",className:"c-activity-graph c-activity-graph--velocity t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},i.a.createElement("div",{className:"o-flex o-flex-align--start"},this.state.velocityStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Speed",i.a.createElement("span",{className:"c-activity-graph__header--supplementary "}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Speed")),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:be,unit:"km"}),i.a.createElement(C,{type:"large",label:"max",value:Ee,unit:"km"})),this.state.velocityStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.velocityStream,dataType:"velocity",dataTypeLegendLabel:"Speed",dataTypeUnit:"KM/H"}):null)):null,_e?i.a.createElement("div",{id:"activityCard--heartrate",className:"c-activity-graph c-activity-graph--heartrate t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},i.a.createElement("div",{className:"o-flex o-flex-align--start"},this.state.heartrateStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Heart Rate",i.a.createElement("span",{className:"c-activity-graph__header--supplementary "}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Heart Rate")),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:_e,unit:"bpm"}),i.a.createElement(C,{type:"large",label:"max",value:ke,unit:"bpm"})),this.state.heartrateStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.heartrateStream,dataType:"heartrate",dataTypeLegendLabel:"Heart Rate",dataTypeUnit:"BPM"}):null)):null,Se?i.a.createElement("div",{id:"activityCard--cadence",className:"c-activity-graph c-activity-graph--cadence t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},i.a.createElement("div",{className:"o-flex o-flex-align--start"},this.state.cadenceStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Cadence",i.a.createElement("span",{className:"c-activity-graph__header--supplementary "}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Cadence")),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:Se,unit:"rpm"})),this.state.cadenceStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.cadenceStream,dataType:"cadence",dataTypeLegendLabel:"Cadence",dataTypeUnit:"RPM"}):null)):null,Ne&&we?i.a.createElement("div",{id:"activityCard--power",className:"c-activity-graph c-activity-graph--power t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},i.a.createElement("div",{className:"o-flex o-flex-align--start"},this.state.wattsStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Power",i.a.createElement("span",{className:"c-activity-graph__header--supplementary"}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Power")),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:Ne,unit:"watts"}),i.a.createElement(C,{type:"large",label:"max",value:xe,unit:"w"})),this.state.wattsStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.wattsStream,dataType:"power",dataTypeLegendLabel:"Power",dataTypeUnit:"W"}):null)):null,pe?i.a.createElement("div",null,i.a.createElement("h3",{className:"t-top-spacing--xl"},"Food Burned"),i.a.createElement("div",{className:"c-activity-food-cards t-top-spacing--l"},i.a.createElement(De,{name:"Bananas",value:je,imageSrc:"/img/food/banana.png"}),i.a.createElement(De,{name:"Cookies",value:Oe,imageSrc:"/img/food/cookie.png"}),i.a.createElement(De,{name:"Cheeseburgers",value:Pe,imageSrc:"/img/food/cheeseburger.png"}),i.a.createElement(De,{name:"Beers",value:Ce,imageSrc:"/img/food/beer.png"}),i.a.createElement(De,{name:"Pizza Slice",value:Te,imageSrc:"/img/food/pizza_slice.png"}),i.a.createElement(De,{name:"Chocolate",value:Le,imageSrc:"/img/food/cadbury_chocolate.png"}))):null))}}]),t}(n.Component);function Me(e){return i.a.createElement("div",{className:"c-athlete-profile"},i.a.createElement("img",{alt:"profile",src:e.athleteData.profile,className:"c-athlete-profile__image"}))}var Be,Fe,Re,We,Ye,He,Je,Ge,qe,Ve,Ze,Ke,Xe,Qe,$e,et,tt,at,nt,it,rt,st,ct=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"c-page-header c-page-header--center-aligned"},i.a.createElement(Me,{athleteData:this.props.athleteData}),i.a.createElement("h3",{className:"o-activity-detail-name"},this.props.data.name),i.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",className:"o-activity-detail-time",href:"https://strava.com/activities/"+this.props.data.id},i.a.createElement("span",null,i.a.createElement(E.a,{format:"MMM DD, YYYY"},this.props.data.start_date),i.a.createElement("span",null," at "),i.a.createElement(E.a,{format:"hh:mm a"},this.props.data.start_date)))))}}]),t}(n.Component),lt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).fetchAthleteData=function(e){fetch("https://www.strava.com/api/v3/athletes/"+e,{method:"get",headers:{"content-type":"application/json",authorization:"Bearer 011c89ee01402ab591de0240d59ee84455fd4d42"}}).then((function(e){return e.json()})).then((function(e){a.setState({athleteData:e})}))},a.state={data:[],loading:!0,athleteId:e.match.params.athlete,activityId:e.match.params.activity,activityFound:!1,athleteData:{}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.athleteUID,a=this.props.match.params.activity;g.database().ref("users/"+t+"/publicActivities").once("value",(function(t){t.forEach((function(t){var n=t.child("activityId").val(),i=t.child("activityData").val(),r=t.child("altitudeStream").val()||null,s=t.child("cadenceStream").val()||null,c=t.child("distanceStream").val()||null,l=t.child("heartrateStream").val()||null,o=t.child("latLngStream").val()||null,m=t.child("velocityStream").val()||null,d=t.child("wattsStream").val()||null;n===a?(e.fetchAthleteData(i.athlete.id),e.setState({data:i,altitudeStream:r,cadenceStream:s,distanceStream:c,heartrateStream:l,latLngStream:o,velocityStream:m,wattsStream:d,loading:!1,activityFound:!0})):e.setState({loading:!1})}))}))}},{key:"render",value:function(){return Be=k.a.round(this.state.data.distance/1e3,1),Fe=k.a.round(this.state.data.total_elevation_gain,0),Re=this.state.data.calories,We=N.a.duration(this.state.data.moving_time,"seconds"),Ye=We._data.hours,He=We._data.minutes,Je=We._data.seconds,Ge=Ye+":"+He+":"+Je,qe=k.a.round(60*this.state.data.average_speed*60/1e3,1),Ve=k.a.round(60*this.state.data.max_speed*60/1e3,1),Ze=k.a.round(this.state.data.average_cadence,1),Xe=k.a.round(this.state.data.average_watts,1),Qe=this.state.data.max_watts,et=this.state.data.device_watts,Ke=this.state.data.average_heartrate,$e=this.state.data.max_heartrate,tt=k.a.round(Re/90,1),at=k.a.round(Re/208,1),nt=k.a.round(Re/50,1),it=k.a.round(Re/303,1),rt=k.a.round(Re/240,1),st=k.a.round(Re/272,1),this.state.loading?i.a.createElement("div",{className:"o-flex o-flex-align--center o-flex-justify--center"},i.a.createElement(T,null)):!this.state.loading&&this.state.activityFound?i.a.createElement("div",{className:"o-wrapper o-activity-detail"},i.a.createElement(ct,{data:this.state.data,athleteData:this.state.athleteData}),i.a.createElement("div",{className:"o-activity-detail__summary"},i.a.createElement("div",{className:"c-activity-summary o-flex o-flex-justify--start"},Be?i.a.createElement(C,{type:"large",label:"distance",value:Be,unit:"km"}):null,Fe?i.a.createElement(C,{type:"large",label:"climb",value:Fe,unit:"m"}):null,Ge?i.a.createElement(C,{type:"large",label:"duration",value:Ge}):null,Re?i.a.createElement(C,{type:"large",label:"calories",value:Re}):null),this.state.data.map.summary_polyline&&i.a.createElement(se,{mapPolyline:this.state.data.map.polyline||this.state.data.map.summary_polyline,startLatlng:this.state.data.start_latlng,endLatlng:this.state.data.end_latlng})),i.a.createElement("div",null,qe?i.a.createElement("div",{className:"c-activity-graph c-activity-graph--velocity t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},this.state.velocityStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Speed",i.a.createElement("span",{className:"c-activity-graph__header--supplementary "}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Speed"),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:qe,unit:"km"}),i.a.createElement(C,{type:"large",label:"max",value:Ve,unit:"km"})),this.state.velocityStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.velocityStream,dataType:"velocity",dataTypeLegendLabel:"Speed",dataTypeUnit:"KM/H"}):null)):null,Ke?i.a.createElement("div",{className:"c-activity-graph c-activity-graph--heartrate t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},this.state.heartrateStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Heart Rate",i.a.createElement("span",{className:"c-activity-graph__header--supplementary "}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Heart Rate"),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:Ke,unit:"bpm"}),i.a.createElement(C,{type:"large",label:"max",value:$e,unit:"bpm"})),this.state.heartrateStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.heartrateStream,dataType:"heartrate",dataTypeLegendLabel:"Heart Rate",dataTypeUnit:"BPM"}):null)):null,Ze?i.a.createElement("div",{className:"c-activity-graph c-activity-graph--cadence t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},this.state.cadenceStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Cadence",i.a.createElement("span",{className:"c-activity-graph__header--supplementary "}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Cadence"),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:Ze,unit:"rpm"})),this.state.cadenceStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.cadenceStream,dataType:"cadence",dataTypeLegendLabel:"Cadence",dataTypeUnit:"RPM"}):null)):null,Xe&&et?i.a.createElement("div",{id:"activityCard--power",className:"c-activity-graph c-activity-graph--power t-top-spacing--l"},i.a.createElement("div",{className:"c-activity-graph-container"},i.a.createElement("div",{className:"o-flex o-flex-align--start"},this.state.wattsStream&&this.state.altitudeStream?i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Power",i.a.createElement("span",{className:"c-activity-graph__header--supplementary"}," ","& Elevation")):i.a.createElement("h3",{className:"t-bottom-spacing--xl"},"Power")),i.a.createElement("div",{className:"t-bottom-spacing--xl o-flex o-flex-justify--start"},i.a.createElement(C,{type:"large",label:"average",value:Xe,unit:"watts"}),i.a.createElement(C,{type:"large",label:"max",value:Qe,unit:"w"})),this.state.wattsStream?i.a.createElement(Q,{altitudeStream:this.state.altitudeStream,distanceStream:this.state.distanceStream,mainDataStream:this.state.wattsStream,dataType:"power",dataTypeLegendLabel:"Power",dataTypeUnit:"W"}):null)):null,Re?i.a.createElement("div",null,i.a.createElement("h3",{className:"t-top-spacing--xl"},"Food Burned"),i.a.createElement("div",{className:"c-activity-food-cards t-top-spacing--l"},i.a.createElement(De,{name:"Bananas",value:tt,imageSrc:"/img/food/banana.png"}),i.a.createElement(De,{name:"Cookies",value:nt,imageSrc:"/img/food/cookie.png"}),i.a.createElement(De,{name:"Cheeseburgers",value:it,imageSrc:"/img/food/cheeseburger.png"}),i.a.createElement(De,{name:"Beers",value:at,imageSrc:"/img/food/beer.png"}),i.a.createElement(De,{name:"Pizza Slice",value:st,imageSrc:"/img/food/pizza_slice.png"}),i.a.createElement(De,{name:"Chocolate",value:rt,imageSrc:"/img/food/cadbury_chocolate.png"}))):null)):i.a.createElement("h1",null,"Activity not found")}}]),t}(n.Component);function ot(){return i.a.createElement("div",{className:"c-empty"},i.a.createElement("p",{className:"c-empty__message"},"No favourite activities"))}var mt=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(o.a)(this,Object(m.a)(t).call(this))).state={data:[],loading:!0},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[];g.database().ref("users/"+this.props.userUid+"/favourites").once("value",(function(a){a.forEach((function(e){t.push(e.val())})),e.setState({data:t,loading:!1})}))}},{key:"render",value:function(){var e=this.state.data.reverse().map((function(e,t){return i.a.createElement(P,{key:t,data:e.activityData,mapDimension:"400x400"})}));return this.state.loading?i.a.createElement("div",{className:"o-flex o-flex-align--center o-flex-justify--center"},i.a.createElement(T,null)):i.a.createElement("div",{className:"o-wrapper o-favourite-activities"},i.a.createElement("div",{className:"c-page-header"},i.a.createElement("div",{className:"o-flex o-flex-justify--start o-flex-align--center"},i.a.createElement("h1",null,"Favourite Activities"))),this.state.data.length>0?i.a.createElement(L.CSSTransitionGroup,{transitionName:"o-transition",transitionAppear:!0,transitionAppearTimeout:500,transitionEnterTimeout:500,transitionLeaveTimeout:300},e):i.a.createElement(ot,null))}}]),t}(n.Component),dt=a(91),ut=a.n(dt),pt=a(127),ht=a.n(pt),vt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).state={loading:!0,data:[],totals:[],ytdRideTotals:{},ytdRunTotals:{},ytdSwimTotals:{}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=y("access_token");fetch("https://www.strava.com/api/v3/athlete",{method:"get",headers:{"content-type":"application/json",authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(t){e.setState({data:t})})).then((function(a){var n="https://www.strava.com/api/v3/athletes/"+e.state.data.id+"/stats";fetch(n,{method:"get",headers:{"content-type":"application/json",authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(t){e.setState({ytdRideTotals:t.ytd_ride_totals,ytdRunTotals:t.ytd_run_totals,ytdSwimTotals:t.ytd_swim_totals,loading:!1})}))}))}},{key:"render",value:function(){var e=k.a.round(this.state.ytdRideTotals.distance/1e3,1),t=k.a.round(this.state.ytdRideTotals.elevation_gain,1),a=k.a.round(this.state.ytdRideTotals.moving_time/60/60,1),n=k.a.round(this.state.ytdRideTotals.elevation_gain/8848,2);return this.state.loading?i.a.createElement(T,null):i.a.createElement("div",{className:"c-ytd"},i.a.createElement("div",{className:"c-ytd__stats"},i.a.createElement("div",{className:"c-ytd__section c-ytd__section--intro"},i.a.createElement("div",{className:"c-ytd__intro"},i.a.createElement("h1",{className:"c-ytd__intro__year"},"20",i.a.createElement("br",null),"20"),i.a.createElement("h1",{className:"c-ytd__intro__title"},"Year",i.a.createElement("br",null),"in",i.a.createElement("br",null),"Review")),i.a.createElement(ft,null)),i.a.createElement(gt,{value:e,unit:"kilometers",type:"ride",title:"This year, you clocked"}),i.a.createElement(gt,{value:t,unit:"meters",type:"ride",title:"You climbed",description:"That translates to climbing Mt Everest "+n+" times!"}),i.a.createElement(gt,{value:a,unit:"hours",type:"ride",title:"You sat in the saddle for"})))}}]),t}(n.Component),gt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e)))._handleWaypointEnter=function(){a.state.counted||(Object(dt.startAnimation)(a.myCountUp),a.setState({value:a.props.value,counted:!0}))},a.state={value:0,counted:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"c-ytd__section c-ytd__section--"+this.props.type},i.a.createElement(ht.a,{bottomOffset:"20%",onEnter:this._handleWaypointEnter}),i.a.createElement("div",{className:"c-ytd__stat"},i.a.createElement("h3",{className:"c-ytd__stat__title"},this.props.title),i.a.createElement("h1",{className:"c-ytd__stat__value"},i.a.createElement(ut.a,{separator:",",start:0,duration:2,end:this.state.value,ref:function(t){e.myCountUp=t}})),i.a.createElement("h3",{className:"c-ytd__stat__unit"},this.props.unit),this.props.description?i.a.createElement("h3",{className:"c-ytd__stat__description"},this.props.description):null))}}]),t}(n.Component);function ft(){return i.a.createElement("svg",{className:"c-ytd__scroll-hint",viewBox:"0 0 539 65",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("g",{id:"Page-2",stroke:"none",fill:"none","fill-rule":"evenodd"},i.a.createElement("path",{d:"M144,32.2686567 C245,32.2686567 239.499145,2.70616862e-15 314.5,0 C389.500855,-3.60822483e-15 413,45.2089552 465.5,45.2089552 C518,45.2089552 539,48.5 539,56.6268657 C539,62.2089552 539,65 539,65 L-2.27373675e-13,65 C-2.27373675e-13,65 -2.27373675e-13,62.2089552 -2.27373675e-13,56.6268657 C-2.27373675e-13,36 43,32.2686567 144,32.2686567 Z",id:"Rectangle",fill:"#FFC236"})))}var yt=vt,bt="";bt="";var Et=function(){return i.a.createElement("div",{className:"c-homepage"},i.a.createElement("div",{className:"c-homepage__hero-message"},i.a.createElement("div",null,i.a.createElement("h1",{className:"c-homepage__hero-header"},i.a.createElement("span",{"aria-label":"banana",role:"img"},"\ud83c\udf4c")),i.a.createElement("h1",{className:"c-homepage__hero-header"},i.a.createElement("span",{className:"c-homepage__logo__emoji"},"banana")),i.a.createElement("p",{className:"c-homepage__hero-subheader"},"Visualize your Strava activities."),i.a.createElement(G,null))),i.a.createElement("div",{className:"c-homepage__hero-image"},i.a.createElement("img",{className:"c-homepage__hero-image__image",alt:"",src:bt+"/img/hero_image-min.png"})))},St="";St="";var _t=function(){return i.a.createElement("footer",{className:"c-footer"},i.a.createElement("img",{alt:"",className:"c-footer__power-by-strava",src:St+"/img/api_logo_pwrdBy_strava_horiz_white.svg"}),i.a.createElement("span",{className:"c-footer__credits"},"Made by ",i.a.createElement("a",{className:"c-link",href:"https://jackylee.co"},"Jacky Lee")))};function Nt(){return i.a.createElement(h.a,{to:"/"})}var xt=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(o.a)(this,Object(m.a)(t).call(this))).state={loggedIn:!1,userMeasurementPreference:null},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=y("access_token"),a=y("token_expires_at"),n=y("refresh_token"),i=Date.now()/1e3;(t||a||n)&&(t?parseInt(a)<i?(console.log("refresh token"),this.setState({loggedIn:!1})):(console.log("access token exists, fetch data"),this.setState({loggedIn:!0})):(console.log("fetch token"),this.setState({loggedIn:!1}))),g.auth().onAuthStateChanged((function(a){a&&t?e.setState({loggedIn:!0,userUid:a.uid}):e.setState({loggedIn:!1})}))}},{key:"render",value:function(){var e=this;return this.state.loggedIn?i.a.createElement("div",{className:"App o-app"},i.a.createElement(Z,{type:"private",authState:this.state.loggedIn}),i.a.createElement("div",{className:"o-content"},i.a.createElement(u.a,null,i.a.createElement(p.a,{path:"/handle_redirect",exact:!0,component:K}),i.a.createElement(p.a,{path:"/year-review",render:function(t){return i.a.createElement(yt,Object.assign({},t,{userUid:e.state.userUid}))}}),i.a.createElement(p.a,{path:"/activities/page/:page",component:M}),i.a.createElement(p.a,{path:"/activities/:id",exact:!0,render:function(t){return i.a.createElement(Ae,Object.assign({},t,{userUid:e.state.userUid}))}}),i.a.createElement(p.a,{path:"/public/:athleteUID/:activity",exact:!0,component:lt}),i.a.createElement(p.a,{path:"/favourites",render:function(t){return i.a.createElement(mt,Object.assign({},t,{userUid:e.state.userUid}))}}),i.a.createElement(p.a,{path:"/",exact:!0,render:function(t){return i.a.createElement(M,Object.assign({},t,{userUid:e.state.userUid}))}}),i.a.createElement(p.a,{component:Nt}))),i.a.createElement(_t,null)):i.a.createElement("div",{className:"App o-wrapper o-app"},i.a.createElement("div",null),i.a.createElement("div",{className:"o-content"},i.a.createElement(u.a,null,i.a.createElement(p.a,{path:"/activities/page/:page",component:M}),i.a.createElement(p.a,{path:"/2017review",component:Nt}),i.a.createElement(p.a,{path:"/handle_redirect",exact:!0,component:K}),i.a.createElement(p.a,{path:"/favourites",exact:!0,component:Et}),i.a.createElement(p.a,{path:"/public/:athleteUID/:activity",exact:!0,component:lt}),i.a.createElement(p.a,{path:"/",exact:!0,component:Et}),i.a.createElement(p.a,{component:Nt}))))}}]),t}(n.Component),kt=a(329);s.a.render(i.a.createElement(kt.a,null,i.a.createElement(xt,null)),document.getElementById("root"))},93:function(e,t,a){}},[[129,1,2]]]);
//# sourceMappingURL=main.69fa27d7.chunk.js.map